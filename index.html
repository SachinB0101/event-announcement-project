<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Announcements</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="container">
        <header>
            <h1>Event Announcements</h1>
            <p>Stay tuned for the latest events and announcements!</p>
            <button onclick="subscribeToEvents()">Subscribe to Events</button>
            <button onclick="showRegisterForm()">Register / Login</button>
        </header>

        <!-- Registration/Login Form -->
        <section id="register-form" style="display:none;">
            <h3>Register / Login</h3>
            <form onsubmit="registerUser(event)">
                <label for="user-email">Email:</label>
                <input type="email" id="user-email" required><br>
                <button type="submit">Submit</button>
            </form>
        </section>

        <section id="events-container">
            <h2>Latest Events</h2>
            <ul id="events-list">
            </ul>
            <!-- Only visible to registered users -->
            <button id="create-event-btn" onclick="showCreateEventForm()" style="display:none;">Create New Event</button>
        </section>

        <!-- Create Event Form Section -->
        <section id="create-event-form" style="display:none;">
            <h3>Create New Event</h3>
            <form onsubmit="submitNewEvent(event)">
                <label for="event-title">Title:</label>
                <input type="text" id="event-title" required><br>
                <label for="event-date">Date:</label>
                <input type="date" id="event-date" required><br>
                <label for="event-description">Description:</label>
                <textarea id="event-description" required></textarea><br>
                <button type="submit">Submit</button>
            </form>
        </section>

        <footer>
            <p>Subscribe to get notified about new events!</p>
            <p>Register to get create new events!</p>
        </footer>

        <script>
            let registeredUser = false;

            // Show registration/login form
            function showRegisterForm() {
                document.getElementById("register-form").style.display = "block";
            }

            // Handle registration/login
            function registerUser(event) {
                event.preventDefault();
                const email = document.getElementById("user-email").value;

                if (email) {
                    registeredUser = true;
                    alert(`Registered successfully as ${email}! You can now create events.`);
                    document.getElementById("register-form").style.display = "none";
                    document.getElementById("create-event-btn").style.display = "inline-block";
                }
            }

            // Load events from local JSON or API
            async function loadEvents() {
                try {
                    const response = await fetch('events.json');
                    if (response.ok) {
                        const events = await response.json();
                        displayEvents(events);
                    }
                } catch (error) {
                    console.error("Error fetching events:", error);
                }
            }

            function displayEvents(events) {
                const eventsList = document.getElementById('events-list');
                eventsList.innerHTML = '';
                events.forEach(event => {
                    const listItem = document.createElement('li');
                    listItem.innerHTML = `<strong>${event.title}</strong> - ${event.date}<br>${event.description}`;
                    eventsList.appendChild(listItem);
                });
            }

            // Show create event form only for registered users
            function showCreateEventForm() {
                if (registeredUser) {
                    document.getElementById("create-event-form").style.display = "block";
                } else {
                    alert("You must register to create events.");
                }
            }

            // Dummy submit function
            function submitNewEvent(event) {
                event.preventDefault();
                alert("Event creation functionality goes here.");
            }

            async function subscribeToEvents() {
                const email = prompt("Enter your email to subscribe to event notifications:");
                if (email) alert("Subscribed successfully!");
            }

            window.onload = loadEvents;
        </script>
    </div>
</body>

</html>
